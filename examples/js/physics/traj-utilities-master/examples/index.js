'use strict';

// MODULES //

var linspace = require( 'compute-linspace' );
var Model = require( './../lib' );


// PARAMETERS //

// theta[group][covariate]
var theta = [
	[0,0,0,0,0,0,0],
	[-3.28038,0.02840,0.99823,-0.00241,-0.26181,0.30905,0.44942],
	[-0.88609,-0.02056,0.32349,-0.01261,0.58967,1.79704,0.71520],
	[-6.24663,0.06858,0.63054,0.02229,0.85485,-0.16842,0.38518],
	[-0.20216,0.00172,-0.66417,0.02278,-0.92519,-0.14904,-0.17241],
	[-0.60344,-0.01998,-0.00223,0.02276,-1.21239,0.69383,0.35655],
	[1.91114,-0.02520,-1.37241,0.02277,-0.01349,-0.50747,-0.40486],
	[-2.54891,0.02645,0.17539,0.01517,1.18093,0.02406,0.25479]
];

// beta[group][outcome][order]
var beta = [
	[
		// Group 1:
		[ 37.58334, -14.41745, 15.18597, -5.50794 ],
		[ 4.12952, 0.11477 ],
		[ 2.51471, 0.13957,  -0.15160, 0.04231 ],
		[ 3.16276, -0.01961 ],
		[ 1.23298, 0.04264 ]
	],
	[
		// Group 2:
		[ 35.75103, -2.06836 ],
		[ 3.70610, 0.12114 ],
		[ 2.38513, 0.10307, -0.16034, 0.05794 ],
		[ 3.22445, 0.03418, -0.02747 ],
		[ 1.32518 ]
	],
	[
		// Group 3:
		[ 31.99769, -21.38305, 18.50259, -6.05029 ],
		[ 4.66102, 0.12594 ],
		[ 2.38223, 0.10664, -0.16735, 0.05892 ],
		[ 3.18357, -0.04491 ],
		[ 1.33869, 0.06917 ]
	],
	[
		// Group 4:
		[ 34.40498, -1.72858 ],
		[ 4.53657 ],
		[ 2.39905, 0.17985, -0.18980, 0.06003 ],
		[ 3.31665, 0.07703, -0.04655 ],
		[ 1.24630 ]
	],
	[
		// Group 5:
		[ 36.31160, 3.82811,  -2.19153 ],
		[ 4.07529, 0.06021 ],
		[ 2.61602, 0.06554, -0.03057 ],
		[ 3.31441, -0.00995 ],
		[ 1.18756 ]
	],
	[
		// Group 6:
		[ 40.54863 ],
		[ 3.11917 ],
		[ 2.50768, 0.08568, -0.04216 ],
		[ 3.26486 ],
		[ 1.26402 ],
	],
	[
		// Group 7:
		[ 52.93640 ],
		[ 3.78002 ],
		[ 2.68022 ],
		[ 3.28163 ],
		[ 1.13459 ]
	],
	[
		// Group 8:
		[ 48.77270 ],
		[ 4.13167 ],
		[ 2.50612 ],
		[ 3.28548 ],
		[ 1.22775 ]
	]
];

var sigma = [
	7.88074,
	0.46272,
	0.08915,
	0.10767,
	0.15289
];
var times = linspace( 0, 2, 18 );

var limits = [
	[0,210],
	[0,7],
	[0,50],
	[0,25],
	[-1,10]
];


// MAIN //

var model = new Model( 5, 8, {
	theta: theta,
	beta: beta,
	sigma: sigma,
	times: times,
	limits: limits
});


// Probabilities for the average patient:
var y = [
	[ 39.78829625,39.31441724175656 ],
	[ 4.01742,4.023626764705883 ],
	[ 2.498895,2.5076613377773254 ],
	[ 3.25422625,3.2546384818339105 ],
	[ 1.2446337500000002,1.2462780147058823 ]
];
var y2 = [
	[null],
	[null],
	[null],
	[null],
	[null]
];
var x = [ 71.447, 0, 38.480, 0, 0, 0 ];
console.log( model.posteriorProbabilities( y2, x ) );

// console.log( model.posteriorProbabilities( y2, x ) );

console.log( JSON.stringify( model.getCollapsedLines( 0,
	[
		[0],
		[1,3],
		[2],
		[4],
		[5,6,7],
	]
) ) );

console.log( JSON.stringify( model.getCollapsedLines( 4,
	[
		[0,1,2,3,4,5,6,7]
	]
) ) );
